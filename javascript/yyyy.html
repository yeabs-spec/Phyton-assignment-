<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <title>TV Shows by Genre</title>
</head>
<body>
  <div class="container mt-4">
    <div class="mb-4" id="genre-buttons"></div>
    <div class="row" id="show-list"></div>
  </div>

  <script>
    const genreButtonsContainer = document.getElementById("genre-buttons");
    const showListContainer = document.getElementById("show-list");

    let url = "https://api.tvmaze.com/shows";

    fetch(url)
      .then(res => res.json())
      .then(data => {
        const genresSet = new Set();
        const genreMap = {};


        data.forEach(show => {
          show.genres.forEach(genre => {
            genresSet.add(genre);
            if (!genreMap[genre]) {
              genreMap[genre] = [];
            }
            genreMap[genre].push(show);
          });
        });


        genresSet.forEach(genre => {
          const btn = document.createElement("button");
          btn.textContent = genre;
          btn.className = "btn btn-outline-primary m-1";
          btn.onclick = () => {
            displayShows(genreMap[genre]);
          };
          genreButtonsContainer.appendChild(btn);
        });
      });

    function displayShows(shows) {
      showListContainer.innerHTML = "";

      shows.forEach(show => {
        const col = document.createElement("div");
        col.className = "col-md-4 mb-4";

        const card = document.createElement("div");
        card.className = "card h-100";

        if (show.image && show.image.medium) {
          const img = document.createElement("img");
          img.src = show.image.medium;
          img.className = "card-img-top";
          card.appendChild(img);
        }

        const body = document.createElement("div");
        body.className = "card-body";

        const title = document.createElement("h5");
        title.className = "card-title";
        title.textContent = show.name;

        const summary = document.createElement("p");
        summary.className = "card-text";
        summary.innerHTML = show.summary || "";

        body.appendChild(title);
        body.appendChild(summary);
        card.appendChild(body);
        col.appendChild(card);
        showListContainer.appendChild(col);
      });
    }
  </script>
</body>
</html>
